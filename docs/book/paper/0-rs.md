# 使用地面激光数据进行树干直径检索的数值计算方法的比较 

摘要：地面激光扫描(TLS)可以作为森林调查的毫米级测量工具。然而，在样地扫描中，干径检索的准确性还不能令人信服。必须对干径检索算法的每个步骤的误差进行评估。在这项研究中，六种数值计算步骤的方法，即圆柱体拟合（CYF）、圆拟合（CF）、凸壳线拟合（CLF）、提议的卡尺模拟方法（CSM）、闭合B-spline曲线拟合（SP）和具有全局凸性的闭合Bézier曲线拟合（SPC），被应用于干径检索，并评估了其   被用来评价茎部切片点云的质量。共使用了从三个Larix kaempferi地块收集的165个胸高的茎切片点云。与现场测量的胸高茎直径（DBHs）相比，CYF、CF、CLF、CSM、SP和SPC方法的均方根误差（RMSEs）分别为0.30cm、0.30cm、0.51cm、0.51cm、0.56cm 和 0.54cm。与SPC方法的结果相比，CSM结果的RMSE为0.05cm。结果表明，CYF和CF方法的表现相同，CLF和CSM方法也是如此。CYF和CF方法检索的大多数DBH比现场测量的DBH小，而CLF、CSM、SP和SPC方法检索的大多数DBH比现场测量的DBH大。这项研究表明，CYF和CF方法表现最好，也最稳健，用直径尺和卡尺的测量结果对林业清查来说足够相似。评估和预处理茎部切片点云是提高茎部直径检索精度的一个潜在方法。


## 1. 绪论

地面激光扫描(TLS)已经成为一种非破坏性地得出三维(3D)森林结构属性的精确手段。TLS有能力获得毫米级的树木三维几何结构，这是传统测量工具所无法做到的。经过20年的研究，可以从TLS数据中自动获取的树木属性不仅包括广泛使用的森林资源，如树木位置[3-5]、干径[6-10]、干高、干冠幅，还包括那些不能用传统工具直接测量的属性，如茎干曲线、茎干体积和其他林业参数。然而，TLS还没有被认为是森林调查中的一个操作工具。除了成本之外，还有一个因素就是很难构建自动的茎干参数检索方法，提供令人信服的测量结果。

茎干直径是森林资源清查中最重要的参数之一，因为一些重要的茎干指标，如茎干锥度结构和适销对路的茎干体积，都是基于这个参数计算的。因此，准确检索茎干直径已成为使用TLS数据进行森林资源调查的重要研究之一。

茎干直径检索算法有许多步骤，如茎干横截面的确定、茎干点的选择、异常值的去除和数值计算。使用圆周拟合（CF）方法检索的胸径（DBH）的准确性受茎截面厚度的影响，在1-10cm范围内获得的值没有明显差异，在10-100cm范围内获得的值有明显差异。在实践中，评估所有茎部直径检索算法的所有步骤中引入的误差是不现实的。然而，所有的茎直径检索算法可以分为两个主要步骤。首先是茎点预处理，主要是数据收集和预处理，如点云注册、地面点去除、茎部定位、茎部横断面确定和茎点选择。下一步是茎部直径检索的数值计算，主要是数值计算方法，如CF和圆柱体拟合（CYF）。这两个步骤的目的是提供高质量的茎部点，并以高精确度检索茎部直径。当这两个目标都达到时，就能获得令人满意的茎部直径。事实上，一些研究将茎部直径检索算法分为与上述类似的两个步骤。例如，第一步是去除离群值或干点选择，下一步是数值计算。然而，这两个步骤的目的是混合在一起的，而不是明确地分别定义。

在过去的20年中，许多干径检索的数值方法被引入并应用于不同的树种和环境因素。归纳起来，这些方法大致可分为两类。(1) 第一类是经典的规则方法。茎被简化为一个规则的几何形状，其中茎的横截面被假定为一个圆形的几何形状。因此，使用CYF、CF、Hough变换和变体方法检索茎的直径。这些方法很容易应用，当茎部点密度不足时，也能输出令人满意的结果，特别是对于单次扫描数据。然而，这些方法忽略了可以从TLS数据中得出的茎部横截面的不规则性，可能并不总是与现实相符。(2) 第二类是模拟人工测量方法。在茎部直径检索中，考虑了茎部横截面的不规则性和现场工作的情景，即直径带通过茎部横截面凸起部分的路径。由此，通过使用凸壳线拟合（CLF）、闭合B-spline曲线拟合（SP）和具有全局凸性的闭合贝塞尔曲线拟合（SPC）模拟直径带的路径来检索茎的直径。这些方法考虑了茎的不规则性，然而，它们很耗时，而且需要高的点密度。然而，在不同的研究中，上述方法在各自的研究材料中都取得了令人满意的结果。由于投入不同，很难直接比较这些方法在不同研究中的表现。这就提出了一个问题：如何选择一个茎部直径检索的数字方法，或者如何在给定的茎部点云中以高精确度检索茎部直径。

除了茎径尺，卡尺也是田间工作中常用的茎径测量工具。卡尺用于测量几个方向的茎部直径，所有方向直径的平均值就是测量的茎部直径。Van Laar和Akca列出了卡尺操作的详细质量规范。在实践中，用直径带测量的茎部直径比用卡尺测量的直径略大。Tang从理论上证明，无论茎部横截面的形状是凸还是凹，用卡尺在各个方向测量的平均茎部直径都等于用茎部直径尺测量的直径。目前，TLS可以捕捉到茎部横截面的几何特征；因此，有可能通过模拟测量，用TLS数据评估茎部直径尺和卡尺之间的等效性。

在这项研究中，我们考虑了几种茎部直径数值计算方法的异同，而不考虑茎点预处理步骤。具体目标是：(1)从实践和理论上评估不同的茎部直径检索数值方法的性能，(2)评估直径带和卡尺之间的等效性，以及(3)讨论提高茎部参数检索准确性的潜在方法。

# 2. 材料和方法

## 2.1. 研究地点和实地数据收集

2018年7月在辽宁省清原县大顾家林场（N42°210，E124°520）获得扫描样本和现场测量的茎径。研究材料来自于三个Larix kaempferi种植园的地块。每个地块的面积为30m×30m，地块的年龄在2018年为25、36和36岁。在现场工作中，DBH是根据测量位置用不锈钢直径带手工测量的，2017年在剥去树皮后用白漆标出（图1）。现场测量的茎干直径的最大值、最小值和平均值分别为34.8厘米、11.7厘米和19.2厘米。

树木从9个TLS站（树种的中心位置，以及每个边界的四个角和中心位置）进行扫描。扫描仪的设备是FARO Focus3D X330。扫描质量为4×（FARO TLS扫描仪的扫描参数），扫描速度为122kpts/s，10米处的点间距为6.136mm，并使用参考球体进行登记。使用FARO Scene5.0软件进行点云登记，三块地的每次登记的平均张力（张力值越低，登记结果越好）分别为0.00261、0.01036和0.00574。之后，根据树干在垂直方向上的连续性提取单棵树的点。从三个地块中分别提取了65、50和50个单株树。


## 2.2. TLS数据预处理

一套数据处理程序被用来获得实验数据。对于一棵树的点云来说，如果半径为1cm的邻接点的数量少于2个，那么异常值就被移除。之后，在20cm到300cm的高度范围内，构建由三维B-spline曲线代表的茎轴曲线。然后，茎的生长方向，即茎横断面的法向量，以及沿茎的高度范围内的茎横断面可以通过构建的茎轴曲线来计算。换句话说，对于高度范围内的一个给定的茎干高度，可以计算出给定高度下的茎干横断面。因此，通过搜索高度变量的合适值，用茎轴曲线计算出位于胸部高度的茎横截面（图2）。之后，由两个平行的茎部横截面形成一个茎部切片，称为下茎部横截面和上茎部横截面。由于当茎横截面的厚度为1-10厘米时，对DBH检索的准确性影响不大，在本研究中，下（上）部与胸高的茎横截面平面平行并在其下方（上方），距离为2.5厘米。因此，提取了一棵树的长度为5cm的茎切片，即两个构建的茎横截面之间的茎点。然后，对于一个茎切片，通过几何变换，将胸高处的茎生长方向的矢量旋转到矢量（0，0，1），得到一个三维茎切片点云。


图2. 计算出的胸高处的茎部横断面。(a)茎轴曲线的茎部横截面位置图，(b)(a)的放大图。蓝色曲线代表茎的横截面，(b)中的红色曲线是构建的茎轴曲线。


在这项研究中，从165棵树上收集了165个三维茎切片点云。茎干直径检索方法分别应用于每个三维茎干切片点云。


## 2.3. 茎秆检索方法


### 2.3.1. 直径带的方法模拟

CYF、CF、CLF、CSM、SP和SPC方法的初始输入是三维茎部切片点云，不同的方法在最终计算中使用从三维茎部点云中得到的不同数据。

CYF方法的最终输入是三维茎切片点云。由于三维茎部切片点云的茎部生长方向通过几何变换被旋转到矢量（0，0，1），茎部生长方向以及拟合圆柱体的轴线方向都等于矢量（0，0，1）。然后，通过CYF使用最小二乘法检索出茎的直径，该方法使用轴线方向作为输入参数。

CF方法的最终输入是二维（2D）茎切片点云，这是三维茎切片点云在水平面上的投影点集。然后，利用最小二乘法，用 CF 检索茎部直径。

CLF方法的最终输入是凸壳点集，它是二维茎切片点云的凸壳。然后，通过连接两个相邻的凸壳点得到一个凸壳多边形。茎直径等于凸壳多边形的周长除以PI。

SP方法的最终输入是凸壳点集。使用全局插值法在凸壳点集上插值了一条封闭的立方B-spline曲线。茎的直径等于封闭B-spline曲线的长度除以PI。

SPC方法的最终输入是凸壳点集。通过构建具有二阶几何连续性和全局凸性的分片立体贝塞尔曲线，得到了闭合凸形贝塞尔曲线。茎部直径等于闭合凸形曲线的长度除以PI。上述方法与茎部切片点云的图示见图3。



图3. 使用椭圆度（第2.3.2节）为6.69%的茎干切片点云的茎干直径检索方法示意图。(a)A3D茎切片点云；(b)3D空间的CYF；(c)3D茎切片点云的投影和CYF的拟合点；(d)CF；(e)3D茎切片点云的投影和其凸壳点；(f)SP；(g)CLF；(h)SPC。(f-h)中的矩形代表相应三种方法的区别部分。黑色的点代表三维空间的茎干点（或它们在二维空间的投影），蓝色的点代表凸壳点，(b)中的红色表面代表拟合圆柱体的表面，红色的点（曲线）代表拟合点（曲线）。


### 2.3.2. 卡尺的方法模拟


据我们所知，还没有使用卡尺模拟的研究来检索使用TLS数据的茎直径。在这项研究中，我们提出了一种卡尺模拟方法（CSM）来检索使用TLS数据的茎干直径。CSM方法的最终输入是凸壳点集。在现场工作中，卡尺的两个臂是平行的，位于每个测量方向的茎干横截面的凸部。因此，两臂可以被看作是两条平行线，正好穿过茎部横截面的凸起部分，而茎部横截面的整个区域位于这两条线之间。为了确保CSM方法的准确性，凸壳点集按角度间隔α（本研究中设定为5）度，以及凸壳点与凸壳点集的几何中心点之间的角度值η，被划分为k（本研究中为72个区域）角度区域。因此，凸壳点落入不同的角度区域。第i个区域和第(i+3602α)个区域(0≤i≤3602α-1)形成第i个卡尺测量方向。然后，卡尺测量可以被模拟3602α次。对于第i个方向，构建两条线来模拟卡尺的两个臂（图4）。两条线的方向矢量是（sin(i×α+α2), cos(i×α+α2)）。


图4. CSM的示意图。黑色的点代表二维茎切片点。蓝色钻石点代表二维茎切片点云的凸壳点。带方块的彩色线条代表模拟的卡尺臂，一个方向的两条线用相同的颜色描述。红色钻石点代表两条线经过的两个凸壳点。


之后，对凸壳点集进行搜索，确保两条线穿过两个确定的凸壳点，并且其他凸壳点位于两条线之间。然后，通过卡尺模拟，这两条线的距离就是第i个区域的茎部直径。最后，在每个方向的卡尺模拟后，计算出最终的茎部直径，即3602α方向的茎部直径的平均值。基于CSM方法，从3602α方向的测量中获取最大和最小的茎直径。因此，三维茎切片点云的椭圆度（百分比）根据以下公式计算。O=(1-DMin DMax)×100(1) 其中DMin和DMax代表从3602α方向测量的最小和最大茎直径。


## 2.4. 茎部切片点云的完全性 


茎切片点云越完整，真实茎切片的几何信息就越清晰，检索出的茎参数就越有说服力。我们希望茎部点能均匀地分布在茎部切片点云的中心。然而，由于各种现场工作的因素，不是所有由TLS扫描的点云都能满足这一要求。本研究根据第2.3.2节中凸壳点集的角度区域，提出了茎部切片点云的完整性C。二维茎部切片点云被分为k个角度区域，角度区间为α（本研究中设定为5），并满足k=360α。茎部切片点云越完整，真实茎部切片的几何信息就越清晰，检索的茎部参数就越有说服力。我们希望茎部点能均匀地分布在茎部切片点云的中心。然而，由于各种现场工作因素，并非所有由TLS扫描的点云都能满足这一要求。本研究根据第2.3.2节中凸壳点集的角度区域，提出了茎部切片点云的完整性C。二维茎部切片点云被分为k个角度区域，角度间隔为α（本研究中设定为5），并满足k=360α。非空角区的数量k初始化为零；如果第i个（`0≤i<k`）角区是一个非空角区，即至少有一个点在当前角区，非空角区的数量k增加1。然后，茎部切片点云的完整性C可按以下方式计算。C=kn k×100(2)


## 4.5. 提高茎部直径检索准确性的潜在途径

茎的生长方向和茎切片点云的厚度是直接影响茎直径检索精度的重要参数。因此，应准确计算茎的生长方向，并通过茎切片点云的质量评估或实验验证调整茎切片点云的厚度。

对于来自单次扫描或多次扫描的茎部切片点云，质量可以首先通过椭圆度和粗糙度进行评估。如果粗糙度或椭圆度超过其阈值，应检查和处理茎部切片点云，以确保没有噪音点或这些点被正确登记。然后，可以用完整度来选择茎部直径检索方法。如果完整性小于阈值，推荐使用CYF或CF方法。当完整性超过其阈值时，考虑到CYF或CF方法检索的大多数茎干直径小于现场测量的直径，而CLF、CSM和SPC方法检索的大多数茎干直径大于现场测量的直径，茎干直径可以由CYF或CF方法检索的茎干直径和CLF、CSM或SPC方法检索的茎干直径的平均值（或线性组合）表示。根据计算复杂性，CYF和CF方法的选择优先顺序是相同的，因为这两种方法都是由最小平方法实现的；CLF、CSM和SPC方法的选择优先顺序是CLF、CSM和SPC。对于椭圆度、粗糙度和完整度的各自阈值以及去除离群点和注册校正的处理方法，还需要进一步研究。

# 5. Conclusions

我们使用一组三维茎部切片点云重点研究了茎部直径检索数字方法的异同，这些点云是使用一个共同的预处理程序提取的，以减少数据预处理的影响。CSM被用来验证茎部直径尺和卡尺测量直径的等效性，而椭圆度、完整性和粗糙度被用来评价茎部切片点云的质量。结果显示，所研究的茎部切片点云的平均椭圆度、完整性和粗糙度值分别为8.80%、94.00%和0.37cm；CYF和CF方法的性能相同，CLF和CSM方法的性能非常接近。CYF和CF方法检索出的大多数茎直径小于现场测量值，而CLF、CSM、SP和SPC方法检索出的大多数茎直径大于现场测量值。与现场测量的DBH相比，CYF、CF、CLF、CSM、SP和SPC方法的RMSE分别为0.30cm、0.30cm、0.51cm、0.51cm、0.56cm和0.54cm。与SPC方法相比，CSM的RMSE为0.05cm。

根据结果，CYF和CF方法检索出的茎直径最接近现场测量，其次是CLF、CSM、SPC和SP方法。CLF和CSM方法具有相似的性能，而CYF和CF方法比其他方法具有更好的稳健性。直径带和卡尺之间的茎干直径测量的等效性对于林业清查是可以接受的。茎点预处理步骤对茎径检索非常重要，确定该步骤的目标并丰富其内容（如茎断面完整性检查、茎断面有效性验证和离群点去除）可提高茎径检索的准确性，特别是对于样地扫描。

